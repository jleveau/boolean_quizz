<!DOCTYPE html>
<html>
<body>
   
    <form id="my_form" >
        <div id="fields">
            
        </div>
        <button type="button" onclick="verify()">Validate</button>
    </form>
    <span id="result"></span>

    <script >
        let op_array = ['AND','OR','OR','OR','OR','OR']
        const mutations = 1
        createForm(op_array)
        apply_mutation(op_array)
        console.log(op_array)

        function apply_mutation() {
            var indexes = []

            while(indexes.length < mutations){
                var random_index = Math.floor(Math.random()*op_array.length-1) + 1;
                if(indexes.indexOf(random_index) === -1) {
                    indexes.push(random_index);
                }
            }
            for (const index of indexes) {
                if (op_array[index] === "AND") {
                    op_array[index] = "OR"
                } else if (op_array[index] === "OR") {
                    op_array[index] = "AND"
                }
            }
        }

        function verify() {
            const values = []
            document.querySelectorAll("#fields > select").forEach(field => {
                values.push(field.value)
            })
            let bug = false

            for (let i = 0; i < op_array.length; i++) {

                value0 = parseInt(values[2*i])
                value1 = parseInt(values[(2*i)+1])
                op = op_array[i]
                switch(op) {
                    case "AND":
                        if (!(value0 && value1)) {
                            bug = true
                        }
                        break
                    case "OR":
                        if (! (value0 || value1)) {
                            bug = true
                        }
                }
                if (bug) {
                    break
                }
            }
            if (bug) {
                document.querySelector("#result").innerHTML = "False"
            } else {
                document.querySelector("#result").innerHTML = "True"
            }
        }

        function createForm() {
            for (let i=0; i<op_array.length;++i) {
                const span = document.createElement('span')
                span.innerHTML = op_array[i]
                document.querySelector("#fields").appendChild(span)

                const select0 = document.createElement("select")
                select0.setAttribute("id", 'field' + 2*i);

                true_option = document.createElement("option")
                true_option.setAttribute("value", 1);
                true_option.innerHTML = "true"

                false_option = document.createElement("option")
                false_option.setAttribute("value", 0);
                false_option.innerHTML = "false"

                document.querySelector("#fields").appendChild(select0)
                document.querySelector("#field" + 2*i).appendChild(true_option)
                document.querySelector("#field" + 2*i).appendChild(false_option)


                const select1 = document.createElement("select")
                select1.setAttribute("id", 'field' + parseInt(2*i+1));

                true_option = document.createElement("option")
                true_option.setAttribute("value", 1);
                true_option.innerHTML = "true"

                false_option = document.createElement("option")
                false_option.setAttribute("value", 0);
                false_option.innerHTML = "false"

                document.querySelector("#fields").appendChild(select1)

                document.querySelector("#field" + parseInt(2*i+1)).appendChild(true_option)
                document.querySelector("#field" + parseInt(2*i+1)).appendChild(false_option)

                document.querySelector("#fields").appendChild(document.createElement("br"))
            }
        }
 
    </script> 

</body>
</html>
